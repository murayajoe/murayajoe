name: Update Stats

on:
  # Run daily at midnight UTC
  schedule:
    - cron: '0 0 * * *'

  # Allows manual workflow dispatch from Actions tab
  workflow_dispatch:

jobs:
  update-readme:
    name: Update README with latest stats
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Update timestamp in README
        run: |
          # Get current date and time
          CURRENT_DATE=$(date -u +"%B %d, %Y at %H:%M UTC")
          echo "Current date: $CURRENT_DATE"

          # This is a placeholder - stats are auto-updated by the external services
          # But we can trigger a commit to refresh the cache
          echo "Stats refreshed on: $CURRENT_DATE" > .github/last-update.txt

      - name: Commit changes
        run: |
          git config --local user.email "joemuraya90@gmail.com"
          git config --local user.name "murayajoe"
          git add -A
          git diff --quiet && git diff --staged --quiet || (git commit -m "ðŸ“Š Updated stats - $(date -u +"%Y-%m-%d")" && git push)
